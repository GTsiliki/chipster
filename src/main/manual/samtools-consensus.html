<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
<head><title></title></head>
<body>

<h2>Utilities / Create consensus sequence from a BAM file</h2>

<h3>Description</h3>

<p>
Given an indexed BAM file and corresponding reference genome (in fasta format), this tool constructs a consensus sequence based on the
alignment. 
</p>

<h3>Parameters</h3>

None

<h3>Details</h3>

<p>
This tool uses SAMtools, bcftools and vcfutils.pl script to create a consensus sequence for the given alignment file.
The actual command line executed is:
<pre>
  samtools mpileup -uf reference.fa aligment.bam | bcftools view -cg - | vcfutils vcf2fq  
</pre>
Note that the input BAM file must be sorted before it can be used by this tool. 
</p>


<h3>Output</h3>

<p>
Output is a fasta formatted sequence file.
</p>

<h3>References</h3>

<p>This tool is based on the <a href = "http://samtools.sourceforge.net/">SAMtools package</a>. 
Please cite the article <a href = "http://www.ncbi.nlm.nih.gov/pubmed/19505943">The Sequence alignment/map (SAM) format and SAMtools</a> by Li H., Handsaker B., Wysoker A., Fennell T., Ruan J., Homer N., Marth G., Abecasis G., Durbin R. and 1000 Genome Project Data Processing Subgroup (2009) Bioinformatics, 25, 2078-9. [PMID: 19505943]. 
</p>

</body>

